strokes = "grey50"
) |>
layout(
yaxis = list(ticksuffix = "%", title = ""),
xaxis = list(showticklabels = TRUE, title = ""),
barmode = 'stack',
hovermode = "x unified"
)
showticklabels
# plot
gr_plotly = plot_ly(
x,
x = ~ Date,
y = ~ Percentage,
type = 'bar',
color = ~ Variant,
stroke = ~ Variant,
strokes = "grey50"
) |>
layout(
yaxis = list(ticksuffix = "%", title = ""),
xaxis = list(showticklabels = TRUE, title = ""),
barmode = 'stack',
hovermode = "x unified"
)
gr_plotly
# Max limit of 50 samples for showing sample names (tick labels)
showticklabels = ifelse(x$Sample |> unique() |> length() <= 50, TRUE, FALSE)
# plot
gr_plotly = plot_ly(
x,
x = ~ Sample,
y = ~ Percentage,
type = 'bar',
color = ~ Variant,
stroke = ~ Variant,
strokes = "grey50"
) |>
layout(
yaxis = list(ticksuffix = "%", title = ""),
xaxis = list(showticklabels = showticklabels, title = ""),
barmode = 'stack',
hovermode = "x unified"
)
gr_plotly
colnames(x)
d1 = order(x$Date, decreasing = F)
d1
x$Date[d1]
d1 = order(x$Date, decreasing = T)
x$Date[d1]
?order
class(x)
x
# reorder by date
if('Date' %in% colnames(x)){
date_reorder = order(x$Date, decreasing = F)
x = x[date_reorder,]
}
x
x %>%
mutate_at("Variant", as.factor) %>%
group_by(get(samplesCluster)) %>%
group_map(# .keep = TRUE,
.f = ~ {
tidyr::complete(data = .x, Variant) %>%
plot_ly(
data = .,
x = ~ Sample,
y = ~ Percentage,
type = 'bar',
color = ~ Variant,
stroke = ~ Variant,
strokes = "grey50",
showlegend = FALSE, # (.y == "B"),
legendgroup = ~ Variant
) |>
layout(
yaxis = list(ticksuffix = "%", title = ""),
xaxis = list(showticklabels = FALSE, title = ""),
barmode = 'stack',
hovermode = "x unified"
)
}) %>%
subplot(nrows = 1,
shareX = TRUE,
shareY = TRUE)
}
x %>%
mutate_at("Variant", as.factor) %>%
group_by(get(samplesCluster)) %>%
group_map(# .keep = TRUE,
.f = ~ {
tidyr::complete(data = .x, Variant) %>%
plot_ly(
data = .,
x = ~ Sample,
y = ~ Percentage,
type = 'bar',
color = ~ Variant,
stroke = ~ Variant,
strokes = "grey50",
showlegend = FALSE, # (.y == "B"),
legendgroup = ~ Variant
) |>
layout(
yaxis = list(ticksuffix = "%", title = ""),
xaxis = list(showticklabels = FALSE, title = ""),
barmode = 'stack',
hovermode = "x unified"
)
}) %>%
subplot(nrows = 1,
shareX = TRUE,
shareY = TRUE)
runApp()
x = freyja_summarized
plot_ly(
x,
x = ~ Date,
y = ~ Percentage,
type = 'bar',
color = ~ Variant,
stroke = ~ Variant,
strokes = "grey50"
) |>
layout(
yaxis = list(ticksuffix = "%", title = ""),
xaxis = list(showticklabels = TRUE, title = ""),
barmode = 'stack',
hovermode = "x unified"
)
plot_ly(
x,
x = ~ Sample,
y = ~ Percentage,
type = 'bar',
color = ~ Variant,
stroke = ~ Variant,
strokes = "grey50"
) |>
layout(
yaxis = list(ticksuffix = "%", title = ""),
xaxis = list(showticklabels = FALSE, title = ""),
barmode = 'stack',
hovermode = "x unified"
)
x
# reorder by date
if('Date' %in% colnames(x)){
date_reorder = order(x$Date, decreasing = F)
x = x[date_reorder,]
}
x
plot_ly(
x,
x = ~ Sample,
y = ~ Percentage,
type = 'bar',
color = ~ Variant,
stroke = ~ Variant,
strokes = "grey50"
) |>
layout(
yaxis = list(ticksuffix = "%", title = ""),
xaxis = list(showticklabels = FALSE, title = ""),
barmode = 'stack',
hovermode = "x unified"
)
plot_ly(
x,
x = ~ Sample,
y = ~ Percentage,
type = 'bar',
color = ~ Variant,
stroke = ~ Variant,
strokes = "grey50"
) |>
layout(
yaxis = list(ticksuffix = "%", title = ""),
xaxis = list(showticklabels = FALSE, title = ""),
barmode = 'stack',
hovermode = "x unified"
)
plot_ly(
x,
x = ~ Date,
y = ~ Percentage,
type = 'bar',
color = ~ Variant,
stroke = ~ Variant,
strokes = "grey50"
) |>
layout(
yaxis = list(ticksuffix = "%", title = ""),
xaxis = list(showticklabels = TRUE, title = ""),
barmode = 'stack',
hovermode = "x unified"
)
plot_ly(
x,
x = ~ reorder(Sample, Date),
y = ~ Percentage,
type = 'bar',
color = ~ Variant,
stroke = ~ Variant,
strokes = "grey50"
) |>
layout(
yaxis = list(ticksuffix = "%", title = ""),
xaxis = list(showticklabels = FALSE, title = ""),
barmode = 'stack',
hovermode = "x unified"
)
plot_ly(
x,
x = ~ Date,
y = ~ Percentage,
type = 'bar',
color = ~ Variant,
stroke = ~ Variant,
strokes = "grey50"
) |>
layout(
yaxis = list(ticksuffix = "%", title = ""),
xaxis = list(showticklabels = TRUE, title = ""),
barmode = 'stack',
# hovermode = "x unified"
)
plot_ly(
x,
x = ~ Date,
y = ~ Percentage,
type = 'bar',
color = ~ Variant,
stroke = ~ Variant,
strokes = "grey50"
) |>
layout(
yaxis = list(ticksuffix = "%", title = ""),
xaxis = list(showticklabels = TRUE, title = ""),
barmode = 'stack'# ,
# hovermode = "x unified"
)
plot_ly(
x,
x = ~ Date,
y = ~ Percentage,
type = 'bar',
color = ~ Variant,
stroke = ~ Variant,
strokes = "grey50"
) |>
layout(
yaxis = list(ticksuffix = "%", title = ""),
xaxis = list(showticklabels = TRUE, title = ""),
barmode = 'stack',
hovermode = "x unified"
)
?structure
DF <- structure(list(macro_sector = c("U Activities of extraterritorial
organisations and bodies", "T Activities of households as employers;
u0ndifferentiated goods- and services-producing activities of households for
own use", "P Education", "O Public administration and defence; compulsory
social security", "K Financial and insurance activities", "S Other service
activities", "A Agriculture, forestry and fishing", "L Real estate
activities", "Q Human health and social work activities", "B Mining and
quarrying ", "E Water supply; sewerage, waste management and remediation
activities", "R Arts, entertainment and recreation", "F Construction", "I
Accommodation and food service activities", "M Professional, scientific and
technical activities", "J Information and communication", "N Administrative
and support service activities", "G Wholesale and retail trade; repair of
motor vehicles and motorcycles", "D Electricity, gas, steam and air
conditioning supply", "H Transportation and storage", "C Manufacturing"),
amount = c(2.2935, 17.6690005, 204.47243683, 347.24800021, 400.12333973,
613.6673475, 657.3337123, 672.74723757, 736.05549391, 828.06106689,
961.82905534, 1538.40117934, 1918.77325865, 2397.02875187, 3941.39973575,
4735.36088945, 5025.39834121, 5913.94010435, 10267.76691901, 12407.11032805,
35782.07991161), macro_sector1 = structure(1:21, .Label = c("U", "T", "P",
"O", "K", "S", "A", "L", "Q", "B", "E", "R", "F", "I", "M", "J", "N", "G",
"D", "H", "C"), class = "factor")), class = c("tbl_df", "tbl", "data.frame"),
row.names = c(NA, -21L)) %>% mutate(amount=round(amount, 2))
fig <-  plot_ly(DF,
x = ~ amount,
y = ~ macro_sector1,
type = 'bar',
hovertext = ~ paste0(macro_sector, "<br>", amount),
hoverinfo = "text")
fig
plot_ly(
x,
x = ~ Date,
y = ~ Percentage,
type = 'bar',
color = ~ Variant,
stroke = ~ Variant,
strokes = "grey50"
) |>
layout(
yaxis = list(ticksuffix = "%", title = ""),
xaxis = list(showticklabels = TRUE, title = ""),
barmode = 'stack',
hovermode = "x unified"
)
plot_ly(
x,
x = ~ Date,
y = ~ Percentage,
type = 'bar',
color = ~ Variant,
stroke = ~ Variant,
strokes = "grey50",
text = ~ Sample
) |>
layout(
yaxis = list(ticksuffix = "%", title = ""),
xaxis = list(showticklabels = TRUE, title = ""),
barmode = 'stack',
hovermode = "x unified"
)
plot_ly(
x,
x = ~ Date,
y = ~ Percentage,
type = 'bar',
color = ~ Variant,
stroke = ~ Variant,
strokes = "grey50",
text = ~ Sample |> unique()
) |>
layout(
yaxis = list(ticksuffix = "%", title = ""),
xaxis = list(showticklabels = TRUE, title = ""),
barmode = 'stack',
hovermode = "x unified"
)
plot_ly(
x,
x = ~ Date,
y = ~ Percentage,
type = 'bar',
color = ~ Variant,
stroke = ~ Variant,
strokes = "grey50",
text = Sample ~ Date
) |>
layout(
yaxis = list(ticksuffix = "%", title = ""),
xaxis = list(showticklabels = TRUE, title = ""),
barmode = 'stack',
hovermode = "x unified"
)
plot_ly(
x,
x = ~ Date,
y = ~ Percentage,
type = 'bar',
color = ~ Variant,
stroke = ~ Variant,
strokes = "grey50",
text = Sample ~ Date
) |>
layout(
yaxis = list(ticksuffix = "%", title = ""),
xaxis = list(showticklabels = TRUE, title = ""),
barmode = 'stack',
hovermode = "x unified"
) %>% add_trace(
hovertext = unique(Sample)
)
plot_ly(
x,
x = ~ Date,
y = ~ Percentage,
type = 'bar',
color = ~ Variant,
stroke = ~ Variant,
strokes = "grey50",
text = Sample ~ Date
) |>
layout(
yaxis = list(ticksuffix = "%", title = ""),
xaxis = list(showticklabels = TRUE, title = ""),
barmode = 'stack',
hovermode = "x unified"
) %>% add_trace(
hovertext = unique(x$Sample)
)
plot_ly(
x,
x = ~ Date,
y = ~ Percentage,
type = 'bar',
color = ~ Variant,
stroke = ~ Variant,
strokes = "grey50",
text = Sample ~ Date
) |>
layout(
yaxis = list(ticksuffix = "%", title = ""),
xaxis = list(showticklabels = TRUE, title = ""),
barmode = 'stack',
hovermode = "x unified"
) %>% add_trace(
hovertext = ~ Sample
)
?plotly
plot_ly(
x,
x = ~ Date,
y = ~ Percentage,
type = 'bar',
color = ~ Variant,
stroke = ~ Variant,
strokes = "grey50",
text = Sample ~ Date
) |>
layout(
yaxis = list(ticksuffix = "%", title = ""),
xaxis = list(showticklabels = TRUE, title = ""),
barmode = 'stack',
hovermode = "x unified"
)
plot_ly(
x,
x = ~ Date,
y = ~ Percentage,
type = 'bar',
color = ~ Variant,
stroke = ~ Variant,
strokes = "grey50"
) |>
layout(
yaxis = list(ticksuffix = "%", title = ""),
xaxis = list(showticklabels = TRUE, title = ""),
barmode = 'stack',
hovermode = "x unified"
)
x %>%
mutate_at("Variant", as.factor) %>%
group_by(get(samplesCluster)) %>%
group_map(# .keep = TRUE,
.f = ~ {
tidyr::complete(data = .x, Variant) %>%
plot_ly(
data = .,
x = ~ Sample,
y = ~ Percentage,
type = 'bar',
color = ~ Variant,
stroke = ~ Variant,
strokes = "grey50",
showlegend = FALSE, # (.y == "B"),
legendgroup = ~ Variant
) |>
layout(
yaxis = list(ticksuffix = "%", title = ""),
xaxis = list(showticklabels = FALSE, title = ""),
barmode = 'stack',
hovermode = "x unified"
)
}) %>%
subplot(nrows = 1,
shareX = TRUE,
shareY = TRUE)
}
gr_plotly = x %>%
mutate_at("Variant", as.factor) %>%
group_by(get(samplesCluster)) %>%
group_map(# .keep = TRUE,
.f = ~ {
tidyr::complete(data = .x, Variant) %>%
plot_ly(
data = .,
x = ~ reorder(Sample, Date),
y = ~ Percentage,
type = 'bar',
color = ~ Variant,
stroke = ~ Variant,
strokes = "grey50",
showlegend = FALSE, # (.y == "B"),
legendgroup = ~ Variant
) |>
layout(
yaxis = list(ticksuffix = "%", title = ""),
xaxis = list(showticklabels = FALSE, title = ""),
barmode = 'stack',
hovermode = "x unified"
)
}) %>%
subplot(nrows = 1,
shareX = TRUE,
shareY = TRUE)
x
plot_ly(
x,
x = ~ Date + Sample,
y = ~ Percentage,
type = 'bar',
color = ~ Variant,
stroke = ~ Variant,
strokes = "grey50"
) |>
layout(
yaxis = list(ticksuffix = "%", title = ""),
xaxis = list(showticklabels = TRUE, title = ""),
barmode = 'stack',
hovermode = "x unified"
)
runApp()
runApp()
runApp()
